# version: 0.2

# phases:
#   install:
#     commands:
#       - echo installing nodejs...
#       - curl -sL https://deb.nodesource.com/setup_12.x | bash -
#       - apt-get install -y nodejs
#       - echo installing yarn...
#       - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add -
#       - echo "deb https://dl.yarnpkg.com/debian/ stable main" | tee /etc/apt/sources.list.d/yarn.list
#       - apt install --no-install-recommends yarn
#   pre_build:
#     commands:
#       - echo installing dependencies...
#       - npm i -g @angular/cli
#       - npm install
#   build:
#     commands:
#       # - echo testing...
#       # - echo building...
#       - ng build --prod
# artifacts:
#   files:
#     - "**/*"
#   discard-paths: no
#   base-directory: dist/FinanceApp


# version: 0.2

# env:
#   variables:
#     APP_NAME: "TractorTracker"
# phases:
#   install:
#     # runtime-versions:
#     #   nodejs: 10
#     commands:
#       - echo install process started
#       - npm install && npm install -g @angular/cli
#       - yarn add @angular-devkit/build-angular --dev
#   build:
#     commands:
#       - echo build process started now
#       - ng build --configuration=production
#   post_build:
#     commands:
#       - echo build process finished, we should uplload to S3 now
#       - cd dist/$APP_NAME
#       - ls -la
#       - aws s3 sync . s3://my-awsome-bucket-of-files --delete

# version: 0.2

# env:
#   variables:
#     APP_NAME: "portfolio"

# phases:
#   install:
#     runtime-versions:
#       nodejs: 12.x
#     commands:
#       - echo Installing source NPM dependencies...
#       - npm install -y npm@latest
#       - npm install -g @angular/cli@12.2.17
#       # - npm install -g @aws-amplify/cli
#       - # Execute Amplify CLI with the helper script'
#       # - amplifyPush --simple
#       # - yarn global add @aws-amplify/cli
#       - rm package-lock.json
#     pre_build:
#       commands:
#       - npm install
#   build:
#     commands:
#       # - amplifyPush --simple
#       - ng build
#   post_build:
#     commands:
#       - echo build process finished, we should upload to S3 now
#       # - cd dist/$APP_NAME
#       # - ls -la
# artifacts:
#   files:
#     - '**/*'
#   base-directory: dist*


# https://stackoverflow.com/questions/65862056/aws-code-pipeline-build-failing-with-module-build-failed
# https://forums.aws.amazon.com/thread.jspa?messageID=997338

version: 0.2

env:
  variables:
    APP_NAME: "portofolio"

phases:
  install:
    runtime-versions:
      nodejs: 12
    commands:
      - echo Installing source NPM dependencies...
      - npm install -y npm@latest
      - npm install -g @angular/cli@12.2.17
      # - npm install -g @aws-amplify/cli
      - # Execute Amplify CLI with the helper script'
      # - amplifyPush --simple
      # - yarn global add @aws-amplify/cli
      - rm package-lock.json
    pre_build:
      commands:
      - npm install
  build:
    commands:
      # - amplifyPush --simple
      - ng build
  post_build:
    commands:
      - echo build process finished, we should upload to S3 now
      # - cd dist/$APP_NAME
      # - ls -la
artifacts:
  files:
    - '**/*'
  base-directory: dist*